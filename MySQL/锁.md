# 锁

## 一、读写锁

读锁是共享的，相互不阻塞的。在多个客户端在同一时刻同时读取同一个资源，而相互不干扰。

写锁是排他的，一个写锁会阻塞其他的写锁和读锁。

因此读锁也叫共享锁，写锁也叫排他锁。这是出于安全策略的考虑，能够确保在给定时间内，只有一个用户能执行写入，并防止其他用户读取正在写入的同一资源。



## 二、锁粒度

在给定的资源上，锁定的数据量越少，则系统的并发程度越高，只要相互之间不发生冲突即可。

> 加锁也需要消耗资源。锁的各种操作，包括获得锁、检查锁是否已经解除、释放锁等，都会增加系统的开销。如果系统花费大量的时间来管理锁，而不是存取数据，那么系统的性能可能会受到影响

每种 MySQL 的存储引擎都可以实现自己的锁策略和锁粒度。



### 1. 表锁

表锁是 MySQL 中最基本的锁策略，并且是开销最小的策略。他会锁定整张表。一个用户在对表进行写操作（插入、删除、更新等）前，需要先获得写锁，这回阻塞其他用户对该表的所有读写操作。只有没有写锁时，其他读取用户才能获取到读锁，读锁之间是不相互阻塞。

写锁比读锁具有更高的优先级，因此一个写锁请求可能会被插入到读锁的前面。

### 2. 行级锁

行级锁可以最大程度地支持并发处理（同时也带来了最大的锁开销）。行级锁只在存储引擎实现，而 MySQL 服务层没有实现。