# 微服务的最佳实践

实践的重要性在于可以从一个项目从理论到真正的落地，而探讨最佳实践也是开发者长久不衰的话题。



## 一、微服务



## 二、微服务拆分

首先，拆分微服务，最重要的思想就是抽象，抽象出不同的业务模型。但有一点，我认为是微服务中最终要的一点，**暴露该暴露的，不该暴露的不要暴露**

在不够成熟的开发中，会出现这样的问题，一个服务把自己的业务逻辑甩锅给下一个服务，从而给下游服务的开发造成压力。

在一个微服务中，对外开放接口，需要对每个逻辑都有相应处理，不能让外部的操作来决定一些本应该由自己解决的问题。

换句话说，作为开发者放心下游服务对自己的业务逻辑进行任意的操作么？

其次，服务的拆分应该是个渐进式的演变，不要想一步到位。往往成功的微服务都是从一个单体演变过来的。



## 三、分库分表

在传统的单体地狱开发中，难免会有一种现象就是库中的表特别多，有些表可能仅仅是创建，从未用过。或者表与表之间存在着很多的强关联现象。从某种角度上来看，这样对于传统开发者来说，是一种负担。

甚至还有一种开发不成熟的表现。例如说，一个项目在开发者经常变动，每当有新需求来临时，就会直接重写 service，在之前的 mapper 中继续补充，结果造成 service 和 mapper 中的 SQL 不断膨胀，复用率极低，之前的代码没人维护。每次开发都跟上战场一样。

**在微服务开发中，一个微服务往往是一个封闭的系统，拥有独立的处理业务能力，并且对于数据的强一致性，关联，仅由自己维护。**

最终的效果就是每个服务仅仅操作少量的表，且表与表之间的关联更为清晰，从而降低开发难度。而达成这样的目的**最基本的一点就是一个服务一个库。**

如果几个服务可能偷懒使用同一个库，这说明，微服务的拆分是失败的，与其这样，不如整合在一起，反而开发个单体更靠谱。



## 四、日志处理

往往一个业务通常会通过多个服务，而在这些不同的服务上打印的日志，这些日志的碎片往往很难直观的为我们解决问题的时候提供帮助，所以日志需要采聚合至一个地方进行处理，进行专业的日志分析。但是往往可能趋于成本等原因很难提供像 Kafka 、ELK 等这样的环境，阿里云是一个不错的选择。



## 五、流量监控、服务熔断/降级/限流





## 六、服务链路追踪



## 七、CI & DevOps

如果不想拉起手刹来开法拉利就要提前考虑这个问题了。



基本上有四个原则

小、轻、松



