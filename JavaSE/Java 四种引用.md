# Java 的四种引用

分成四个部分

* 强引用
* 弱引用
* 软引用
* 虚引用



## 1. 强引用

最普遍的引用：Object o = new Object();

* 宁愿抛出 OOM，也不会回收对象。

* 将对象显式的置为 null 可以帮助垃圾收集器回收此对象



## 2. 软引用

用来描述一些还有用，但是并非必须的对象，在 Java 中用 SoftReference 类来表示。

* 对于，软引用关联着的对象，只有在内存不足的时候 JVM 才会回收该对象。

* 软引用可以和一个引用队列 (ReferenceQueue) 联合使用，如果软引用锁引用的对象被垃圾回收器回收，JVM 就会把这个软引用加入到与之关联的引用队列中。



## 3. 弱引用

只具有弱引用的对象拥有更短暂的生命周期。

* 在垃圾回收线程扫描它所管辖的内存区域的过程中，一旦发现了只具有虚引用的对象，不管当前内存空点足够与否，都会回收它的内存。但是，垃圾回收线程是一个优先级很低的线程，因此不一定很快的就会发现那些只有若引用的对象。

* 如果这个对象是偶尔的使用，并且希望在使用时随时就能获取到，但又不想印象此对象的垃圾收集器，那么你应该用 Weak Reference 来记住此对象。
* 弱引用可以被用来实现一些规范化映射，如 WeakHashMap，当 key 或者 value 的值不再被引用的时候可以自动被回收。



弱化指针是一种客观现象

在编程中

```java
Person p = new Person() // 创建对象
...
p = null; // 手动切断 GC 可达性
```

在这种情况下，比较麻烦，需要我们手动去操作，还有一种比较好的实现方式

```java
WeakReerence<Person> wr = new WeakReference<Person>(new Person());
```

这种方式我们不用再去关注指针，只要没有强引用指向 Person 对象，垃圾收集器每次运行都会自动将该对象释放。



## 4. 虚引用

虚引用也成为幻影引用，一个对象都有虚引用的存在都不会对生存时间都构成影响，也无法通过虚引用来获取一个对象的真实引用。

* 唯一的用处：用来跟踪垃圾回收器的活动，能在对象被 GC 的时候收到系统通知，用 RhantomReference 表示。



