# 封装

## 一、问题

最近有一个任务，用来更新设备7天在线离线，解决方案是将在线离线信息存入 redis 实现的。任务不是很复杂，但是在数据的一致性上频频出现问题。

就更新设备在线离线状态来说

```
// 当上游发送设备心跳
// 1. 更新设备表中设备在线离线状态
// 2. 将数据存储 redis
```

```
// 当上游通过另一个渠道发送设备的在线离线信息
// 1. 更新设备表中设备在线离线状态
// 2. 将数据存储 redis
```

应该将 1 2 步骤封装在一个服务一个方法里面



## 二、意义

封装的意义大概就是如此，通过暴露有限的方法，来提高功能的易用性。可以减少不必要的操作，提高排查和解决问题的效率



